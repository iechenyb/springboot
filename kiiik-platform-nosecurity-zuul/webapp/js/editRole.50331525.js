(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["editRole"],{"09d5":function(e,t,n){},"5fac":function(e,t,n){"use strict";var r=n("09d5"),i=n.n(r);i.a},da1d:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"editRole"},[n("h1",[e._v("角色编辑")]),n("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.search}},[n("el-form-item",[n("el-input",{attrs:{placeholder:"搜索角色"},model:{value:e.search.roleName,callback:function(t){e.$set(e.search,"roleName",t)},expression:"search.roleName"}})],1),n("el-form-item",{staticClass:"add"},[n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.openDialog(e.STATE.add)}}},[e._v("\n        添加\n      ")])],1)],1),n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""}},[n("el-table-column",{attrs:{prop:"roleName",label:"角色名称"}}),n("el-table-column",{attrs:{prop:"description",label:"角色描述"}}),n("el-table-column",{attrs:{label:"角色权限"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(n){e.showMenuDialog=!0,e.selectRole=t.row}}},[e._v("\n          编辑权限\n        ")])]}}])}),n("el-table-column",{attrs:{label:"操作",width:"170px"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(n){e.openDialog(e.STATE.update,t.row)}}},[e._v("\n          编辑\n        ")]),n("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(n){e.remove(t.row.id)}}},[e._v("\n          删除\n        ")])]}}])})],1),n("el-pagination",{attrs:{"current-page":e.page.curPage,"page-sizes":[10,20,30,50],"page-size":e.page.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":function(t){return e.page.pageSize=t},"current-change":function(t){return e.page.curPage=t}}}),n("el-dialog",{attrs:{title:e.dialogTitle,visible:e.showDialog},on:{"update:visible":function(t){e.showDialog=t}}},[n("el-form",{attrs:{model:e.editinfo,"label-position":"right","label-width":"150px"}},[n("el-form-item",{attrs:{label:"角色名称"}},[n("el-input",{model:{value:e.editinfo.roleName,callback:function(t){e.$set(e.editinfo,"roleName",t)},expression:"editinfo.roleName"}})],1),n("el-form-item",{attrs:{label:"角色描述"}},[n("el-input",{model:{value:e.editinfo.description,callback:function(t){e.$set(e.editinfo,"description",t)},expression:"editinfo.description"}})],1)],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.showDialog=!1}}},[e._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确 定")])],1)],1),n("editRoleMenu",{attrs:{show:e.showMenuDialog,role:e.selectRole},on:{"update:show":function(t){e.showMenuDialog=t}}})],1)},i=[],a=(n("96cf"),n("1da1")),s=(n("cadf"),n("551c"),n("097d"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{attrs:{title:e.role.roleName,visible:e.show},on:{"update:visible":function(t){e.$emit("update:show",!1)}}},[n("el-tree",{ref:"menuTree",attrs:{data:e.tree,props:e.defaultProps,"show-checkbox":"","node-key":"id"}}),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.$emit("update:show",!1)}}},[e._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:e.editmenu}},[e._v("确 定")])],1)],1)}),o=[],u=n("8680"),c={name:"editRoleMenu",data:function(){return{defaultProps:{children:"children",label:"menuName"}}},props:["role","show"],asyncComputed:{tree:function(){var e=Object(a["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,u["b"].getSystemMenuTree();case 2:return t=e.sent,e.abrupt("return",t.children);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},watch:{role:function(){var e=Object(a["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.refreshSelects(t);case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},methods:{refreshSelects:function(){var e=Object(a["a"])(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.$refs.menuTree&&this.$refs.menuTree.setCheckedKeys([]),e.next=3,u["e"].get({roleId:t.id});case 3:n=e.sent,n=n.list.map(function(e){return e.menuId}),this.$refs.menuTree.setCheckedKeys(n);case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),editmenu:function(){var e=Object(a["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=this.$refs.menuTree.getCheckedNodes().map(function(e){return e.id}),e.next=3,u["e"].saveRoleMenuBatch(this.role.id,t);case 3:if(!e.sent){e.next=6;break}this.$message({type:"success",message:"权限更新成功!",duration:500}),this.$emit("update:show",!1);case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}},l=c,p=n("2877"),d=Object(p["a"])(l,s,o,!1,null,null,null);d.options.__file="editRoleMenu.vue";var h=d.exports,f=n("2ef0"),m=n.n(f),g={description:null,id:null,roleName:null},b={roleName:""},w={data:function(){return{search:JSON.parse(JSON.stringify(b)),debounceSearch:JSON.parse(JSON.stringify(b)),page:Object(u["a"])(),total:0,STATE:{add:0,update:1},state:null,showDialog:!1,editinfo:JSON.parse(JSON.stringify(g)),showMenuDialog:!1,selectRole:JSON.parse(JSON.stringify(g))}},components:{editRoleMenu:h},asyncComputed:{tableData:function(){var e=Object(a["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,u["d"].get(this.debounceSearch,this.page);case 2:return t=e.sent,this.total=t.total,this.page.curPage=this.page.curPage<t.pages?this.page.curPage:t.pages,e.abrupt("return",t.list);case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},computed:{dialogTitle:function(){var e=null;return this.state===this.STATE.add?e="添加角色":this.state===this.STATE.update&&(e="更新角色"),e}},watch:{search:{handler:m.a.debounce(function(e){this.debounceSearch=JSON.parse(JSON.stringify(e)),this.page.curPage=1},500),deep:!0}},methods:{refresh:function(){this.debounceSearch=JSON.parse(JSON.stringify(this.debounceSearch)),this.showDialog=!1,this.editinfo=JSON.parse(JSON.stringify(g))},openDialog:function(e,t){this.state=e,this.showDialog=!0,this.editinfo=t?JSON.parse(JSON.stringify(t)):JSON.parse(JSON.stringify(g))},confirm:function(){this.state===this.STATE.add?this.add():this.state===this.STATE.update&&this.update()},add:function(){var e=Object(a["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,u["d"].add(this.editinfo);case 2:if(!e.sent){e.next=5;break}this.$message({type:"success",message:"添加成功!",duration:500}),this.refresh();case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),update:function(){var e=Object(a["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,u["d"].update(this.editinfo);case 2:if(!e.sent){e.next=5;break}this.$message({type:"success",message:"更新成功!",duration:500}),this.refresh();case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),remove:function(){var e=Object(a["a"])(regeneratorRuntime.mark(function e(t){var n=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.$confirm("此操作将永久删除该, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(a["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,u["d"].deleteByIds(t);case 2:if(!e.sent){e.next=5;break}n.$message({type:"success",message:"删除成功!",duration:500}),n.refresh();case 5:case"end":return e.stop()}},e,this)})));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}},v=w,y=(n("5fac"),Object(p["a"])(v,r,i,!1,null,null,null));y.options.__file="index.vue";t["default"]=y.exports}}]);
//# sourceMappingURL=editRole.50331525.js.map